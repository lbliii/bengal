
---
title: "utils"
type: "python-module"
source_file: "bengal/bengal/autodoc/utils.py"
line_number: 1
description: "Utility functions for autodoc system. Provides text sanitization and common helpers for all extractors."
---

# utils
**Type:** Module
**Source:** [View source](bengal/bengal/autodoc/utils.py#L1)



**Navigation:**
[bengal](/api/bengal/) ›[autodoc](/api/bengal/autodoc/) ›utils

Utility functions for autodoc system.

Provides text sanitization and common helpers for all extractors.

## Functions



### `sanitize_text`


```python
def sanitize_text(text: str | None) -> str
```



Clean user-provided text for markdown generation.

This function is the single source of truth for text cleaning across
all autodoc extractors. It prevents common markdown rendering issues by:

- Removing leading/trailing whitespace
- Dedenting indented blocks (prevents accidental code blocks)
- Normalizing line endings
- Collapsing excessive blank lines


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `text` | `str \| None` | - | Raw text from docstrings, help text, or API specs |







**Returns**


`str` - Cleaned text safe for markdown generation
:::{rubric} Examples
:class: rubric-examples
:::


```python
>>> text = '''
    ...     Indented docstring text.
    ...
    ...     More content here.
    ... '''
    >>> sanitize_text(text)
    'Indented docstring text.\n\nMore content here.'
```





### `truncate_text`


```python
def truncate_text(text: str, max_length: int = 200, suffix: str = '...') -> str
```



Truncate text to a maximum length, adding suffix if truncated.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `text` | `str` | - | Text to truncate |
| `max_length` | `int` | `200` | Maximum length (default: 200) |
| `suffix` | `str` | `'...'` | Suffix to add if truncated (default: '...') |







**Returns**


`str` - Truncated text
:::{rubric} Examples
:class: rubric-examples
:::


```python
>>> truncate_text('A very long description here', max_length=20)
    'A very long descr...'
```





### `auto_detect_prefix_map`


```python
def auto_detect_prefix_map(source_dirs: list[Path], strip_prefix: str = '') -> dict[str, str]
```



Auto-detect grouping from __init__.py hierarchy.

Scans source directories for packages (directories containing __init__.py)
and builds a prefix map for every package path. Each entry maps the full
dotted module path to its slash-separated path relative to the stripped
prefix (e.g., "cli.templates" → "cli/templates"). Using the full path
ensures nested packages stay under their parent directories (cli/templates
lives under cli/).


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `source_dirs` | `list[Path]` | - | Directories to scan for packages |
| `strip_prefix` | `str` | `''` | Optional dotted prefix to remove from detected modules |







**Returns**


`dict[str, str]` - Prefix map: {"package.path": "group_path"}
:::{rubric} Examples
:class: rubric-examples
:::


```python
>>> auto_detect_prefix_map([Path("bengal")], "bengal.")
    {
        "cli": "cli",
        "cli.templates": "cli/templates",
        "core": "core",
        "cache": "cache",
    }
```





### `apply_grouping`


```python
def apply_grouping(qualified_name: str, config: dict[str, Any]) -> tuple[str | None, str]
```



Apply grouping config to qualified module name.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `qualified_name` | `str` | - | Full module name (e.g., "bengal.cli.templates.blog") |
| `config` | `dict[str, Any]` | - | Grouping config dict with mode and prefix_map |







**Returns**


`tuple[str | None, str]` - Tuple of (group_name, remaining_path):
    - group_name: Top-level group (or None if no grouping)
    - remaining_path: Path after group prefix
:::{rubric} Examples
:class: rubric-examples
:::


```python
>>> apply_grouping("bengal.cli.templates.blog", {
    ...     "mode": "auto",
    ...     "prefix_map": {"cli.templates": "templates"}
    ... })
    ("templates", "blog")
```



---
*Generated by Bengal autodoc from `bengal/bengal/autodoc/utils.py`*
