
---
title: "query_index_registry"
type: "python-module"
source_file: "../bengal/bengal/cache/query_index_registry.py"
line_number: 1
description: "Query Index Registry - Manages all query indexes. Coordinates: - Index registration (built-in + custom) - Index building (full + incremental) - Index persistence - Template access Architecture: - Lazy..."
---

# query_index_registry
**Type:** Module
**Source:** [View source](../bengal/bengal/cache/query_index_registry.py#L1)



**Navigation:**
[bengal](/api/bengal/) ›[cache](/api/bengal/cache/) ›query_index_registry

Query Index Registry - Manages all query indexes.

Coordinates:
- Index registration (built-in + custom)
- Index building (full + incremental)
- Index persistence
- Template access

Architecture:
- Lazy initialization (only load when needed)
- Automatic built-in registration
- Support for custom user indexes
- Incremental updates with dependency tracking

## Classes




### `QueryIndexRegistry`


Registry for all query indexes.

Manages the lifecycle of query indexes:
- Registration (built-in + custom)
- Building (full + incremental)
- Persistence
- Template access via site.indexes









## Methods



#### `__init__`
```python
def __init__(self, site: Site, cache_dir: Path)
```


Initialize registry.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `site` | `Site` | - | Site instance |
| `cache_dir` | `Path` | - | Directory for index cache files |










#### `register`
```python
def register(self, name: str, index: QueryIndex) -> None
```


Register a query index.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `name` | `str` | - | Index name (e.g., 'section', 'author', 'status') |
| `index` | `QueryIndex` | - | QueryIndex instance |







**Returns**


`None`



#### `build_all`
```python
def build_all(self, pages: list[Page], build_cache: BuildCache, skip_generated: bool = True) -> None
```


Build all indexes from scratch (full build).


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `pages` | `list[Page]` | - | All site pages |
| `build_cache` | `BuildCache` | - | Build cache for dependency tracking |
| `skip_generated` | `bool` | `True` | Skip generated pages (tag pages, etc.) |







**Returns**


`None`



#### `update_incremental`
```python
def update_incremental(self, changed_pages: list[Page], build_cache: BuildCache, skip_generated: bool = True) -> dict[str, set[str]]
```


Update indexes incrementally for changed pages.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `changed_pages` | `list[Page]` | - | Pages that changed |
| `build_cache` | `BuildCache` | - | Build cache for dependency tracking |
| `skip_generated` | `bool` | `True` | Skip generated pages |







**Returns**


`dict[str, set[str]]` - Dict mapping index_name → affected_keys



#### `get`
```python
def get(self, index_name: str) -> QueryIndex | None
```


Get index by name.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `index_name` | `str` | - | Index name (e.g., 'section', 'author') |







**Returns**


`QueryIndex | None` - QueryIndex instance or None if not found



#### `__getattr__`
```python
def __getattr__(self, name: str) -> QueryIndex
```


Allow attribute-style access: registry.section instead of registry.get('section').


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `name` | `str` | - | Index name |







**Returns**


`QueryIndex` - QueryIndex instance
:::{rubric} Raises
:class: rubric-raises
:::

- **`AttributeError`**:If index not found




#### `has`
```python
def has(self, index_name: str) -> bool
```


Check if index exists.


**Parameters:**

| Name | Type | Default | Description |
|:-----|:-----|:--------|:------------|
| `index_name` | `str` | - | Index name |







**Returns**


`bool` - True if index is registered



#### `save_all`
```python
def save_all(self) -> None
```


Save all indexes to disk.



**Returns**


`None`



#### `stats`
```python
def stats(self) -> dict[str, Any]
```


Get statistics for all indexes.



**Returns**


`dict[str, Any]` - Dict with index stats



#### `__repr__`
```python
def __repr__(self) -> str
```


String representation.



**Returns**


`str`



---
*Generated by Bengal autodoc from `../bengal/bengal/cache/query_index_registry.py`*
