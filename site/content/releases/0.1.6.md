---
title: Bengal 0.1.6
description: Link previews, template conveniences, CSS tree shaking, and cross-theme extends
type: changelog
date: 2025-12-23
draft: false
lang: en
tags: [release, changelog, performance, navigation, link-previews, templates, css, theming]
keywords: [release, 0.1.6, link-previews, author, series, sharing, css-tree-shaking, cross-theme]
category: changelog
---

# Bengal 0.1.6

**Key additions:** Wikipedia-style link previews, rich template conveniences (author, series, sharing, archives), CSS tree shaking, cross-theme template extends, and smart hot reload.

---

## Highlights

### Link Previews

Hover over any internal link to see a preview card with title, excerpt, reading time, and tags—Wikipedia-style:

```toml
# Enabled automatically when per-page JSON is configured
[output_formats]
per_page = ["json"]

# Optional customization
[link_previews]
hover_delay = 200        # ms before showing
show_reading_time = true
show_tags = true
max_tags = 3
```

Features:
- **Prefetch on hover intent** — starts loading before the delay completes
- **Mobile support** — long-press (500ms) shows preview with haptic feedback
- **Keyboard accessible** — Tab to focus, Escape to close
- **Smart exclusions** — nav, TOC, breadcrumbs don't show previews

Disable for specific links with `data-no-preview`:

```html
<a href="/docs/api/" data-no-preview>API Reference</a>
```

### Inline Asset Tracking

Assets are now extracted inline during rendering instead of in a separate pass. No configuration needed—it just happens.

### Smart CSS Hot Reload

The dev server now detects when only CSS changed and refreshes styles without a full page reload. Your scroll position and component state stay intact.

### Navigation Tree Architecture

Navigation rendering uses a pre-computed, cached structure:

- Pre-built tree avoids per-request computation
- Per-version caching preserves memory across rebuilds

Custom themes can use the new `NavTree` API:

```jinja
{% for node in nav_tree.children %}
  <a href="{{ node.url }}" {% if node.active %}class="active"{% endif %}>
    {{ node.title }}
  </a>
{% endfor %}
```

### AST-Based Content Pipeline

Markdown is now parsed once to an Abstract Syntax Tree, with all outputs (HTML, TOC, plain text, links) derived from that single parse:

| Property | Description |
|----------|-------------|
| `page.ast` | Parsed syntax tree |
| `page.html` | Rendered from AST |
| `page.plain_text` | For search indexing |

This eliminates duplicate parsing and enables type-safe content transformations.

### Template Conveniences

Rich helpers for blog-style sites:

**Author support** — full metadata with social links and avatars:

```jinja
{{ page.author.name }}
{{ page.author.avatar }}
{% for link in page.author.social_links %}
  <a href="{{ link.url }}">{{ link.platform }}</a>
{% endfor %}
```

**Series navigation** — multi-part content with automatic prev/next:

```jinja
{% if page.series %}
  Part {{ page.series.current_index }} of {{ page.series.total }}
  {% if page.prev_in_series %}<a href="{{ page.prev_in_series.url }}">Previous</a>{% endif %}
  {% if page.next_in_series %}<a href="{{ page.next_in_series.url }}">Next</a>{% endif %}
{% endif %}
```

**Social sharing** — one-liner share URLs:

```jinja
<a href="{{ share_twitter(page) }}">Tweet</a>
<a href="{{ share_linkedin(page) }}">Share on LinkedIn</a>
<a href="{{ share_facebook(page) }}">Share on Facebook</a>
```

Also: `share_reddit()`, `share_hackernews()`, `share_mastodon()`, `share_email()`

**Date and archive helpers**:

```jinja
{{ page.date | days_ago }} days ago
{{ page.date | month_name }}

{% for year, posts in posts | group_by_year %}
  <h2>{{ year }}</h2>
  {% for post in posts %}...{% endfor %}
{% endfor %}
```

**Section stats** — aggregate properties:

```jinja
{{ section.post_count }} posts
{{ section.total_reading_time }} min total
{% for post in section.featured_posts %}...{% endfor %}
```

### CSS Tree Shaking

Production builds now analyze which CSS classes are actually used and strip unused rules:

```toml
[css]
tree_shaking = true  # enabled by default in production
```

The optimizer scans rendered HTML to build a class allowlist, then removes unused selectors from CSS bundles.

### Cross-Theme Template Extends

Custom themes can extend templates from any installed theme using the new prefix syntax:

```jinja
{% extends "default/base.html" %}

{% block content %}
  {# Your customizations here #}
{% endblock %}
```

This enables partial theme overrides without copying entire template files.

---

## Other Improvements

### JavaScript Refinements

- **Shared utilities** — new `utils.js` with clipboard, debounce, throttle, focus trap
- **Memory leak fix** — TOC scroll spy now properly cleans up event listeners
- **Timeout fix** — action bar fetches now have a 5-second timeout instead of hanging
- **Debug mode** — enable with `window.Bengal.debug = true` to see detailed logs

### CLI & Dashboard

- **`bengal graph`** — promoted to top-level command (was `bengal utils graph`)
- **`bengal analyze`** — unified analysis combining graph metrics, suggestions, and orphans
- **`bengal graph orphans`** — find disconnected pages with connectivity filtering
- **Build dashboard** — real-time stats panel with cache hit rate, memory usage, and phase timings
- **Dashboard compatibility** — fixed Visual API signatures for Textual 6.x

### Social Cards (Experimental)

Auto-generated Open Graph images for social media previews. Disabled by default for compatibility with free-threading Python:

```toml
[social_cards]
enabled = true
```

### Developer Experience

- **Directive priorities** — `include` runs first, navigation directives run late
- **Config deprecation warnings** — clear migration messages for old settings
- **Cache auto-invalidation** — caches invalidate on Python/Bengal version upgrades
- **Autodoc enhancements** — `_path` and `href` properties on all DocElements

### Bug Fixes

- Fixed baseurl not applying to hardcoded paths in directives and templates
- Fixed social card segfaults in free-threading Python (sequential generation)
- Added `section_path` property to Page/PageProxy for consistent URL building

---

## Upgrading

```bash
uv pip install --upgrade bengal
# or
pip install --upgrade bengal
```

All changes are backward compatible. Link previews activate automatically when you have per-page JSON enabled, CSS tree shaking runs automatically in production builds, and existing configs work unchanged.

**Note:** If using Textual for the dashboard, version 0.96+ is now required.

---

## Links

- [Documentation](https://github.com/lbliii/bengal)
- [Issue Tracker](https://github.com/lbliii/bengal/issues)
- [Full Changelog](https://github.com/lbliii/bengal/blob/main/changelog.md)
