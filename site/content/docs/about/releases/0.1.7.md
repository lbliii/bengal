---
title: "Bengal 0.1.7"
description: "Kida template engine, Patitas parser, Rosettes highlighter, and comprehensive error system"
date: 2026-01-01
weight: -107
---

**Released**: January 1, 2026

This release introduces three major new subsystems‚ÄîKida, Patitas, and Rosettes‚Äîalong with comprehensive error handling and significant performance improvements.

## Highlights

- **Kida Template Engine** ‚Äî Pure-Python template engine with Jinja2 compatibility, now the default
- **Patitas Markdown Parser** ‚Äî Typed AST parser with O(n) lexer and 54 directive handlers
- **Rosettes Syntax Highlighter** ‚Äî GIL-safe highlighting for Python 3.14t with 50+ languages
- **Error System** ‚Äî Structured error codes across all packages with session tracking
- **Big O Optimizations** ‚Äî Algorithm improvements yielding 2-13x speedups in critical paths

---

## üöÄ Major Features

### Kida Template Engine

Bengal now ships with **Kida**, a pure-Python template engine designed for Python 3.14's free-threading.

**Key capabilities**:

- `{% match %}` pattern matching with guards
- Pipeline operators `|>` for filter chaining
- Optional chaining `??` for nil-resilient access
- `{% while %}` loops, `{% cache %}`, `{% slot %}`, `{% embed %}`
- Bytecode caching with site-wide `BlockCache`
- Compile-time filter validation with "Did you mean?" suggestions

```kida
{% match page.layout %}
  {% case "post" %}
    {% include "layouts/post.html" %}
  {% case "doc" | "reference" %}
    {% include "layouts/doc.html" %}
  {% default %}
    {% include "layouts/default.html" %}
{% endmatch %}

{# Pipeline operators #}
{{ pages |> where("draft", false) |> sort_by("date") |> first }}

{# Optional chaining #}
{{ page.author?.avatar ?? "/images/default-avatar.png" }}
```

Jinja2 remains fully supported. Set `template_engine: jinja2` in your config to use it.

### Patitas Markdown Parser

**Patitas** is a new markdown parser with a typed AST and O(n) lexer, designed for extensibility.

- 54 directive handlers with full Bengal parity
- Zero-Copy Lexer Handoff (ZCLH) protocol for Rosettes integration
- Directive and role systems for custom markup

```yaml
# Enable in config
markdown:
  parser: patitas  # or "mistune" (default)
```

### Rosettes Syntax Highlighter

**Rosettes** provides pure-Python syntax highlighting that doesn't re-enable the GIL on Python 3.14t.

- 50+ languages including tree structures, MyST, Jinja2, configs
- Semantic token system with CSS theming (RFC-0003)
- Automatic fallback to Pygments when needed

```yaml
# Enable in config
highlighting:
  backend: rosettes  # or "pygments" (default)
```

---

## üîß Error System

All packages now use structured error codes with actionable suggestions:

| Series | Package | Example |
|--------|---------|---------|
| A | Cache | `A001: Cache version mismatch` |
| B | Orchestration | `B003: Build phase failed` |
| C | Config | `C002: Invalid configuration key` |
| D | Discovery | `D008: Content fetch failed` |
| N | Collections | `N011: Collection not found` |
| O | Autodoc | `O003: Extraction failed` |
| V | Health | `V001: Validation error` |
| X | Assets | `X007: Asset not found` |

Session tracking via `record_error()` captures silent failures for debugging.

---

## ‚ö° Performance

### Algorithm Optimizations

| Area | Before | After | Improvement |
|------|--------|-------|-------------|
| Cache affected pages | O(n) scan | O(1) lookup | Reverse dependency graph |
| Taxonomy lookups | O(n) | O(1) | Reverse index |
| DirectiveAnalyzer | O(L¬≤) | O(L) | Index-based checks |
| AutoFixer | O(D¬≤) | O(D) | Dict lookup |
| LLM streaming | O(n√óc) memory | O(c) | Streaming writes |
| LocalSource (2K files) | baseline | 2.5x faster | Regex pre-compilation |
| GitHubSource | baseline | 10x faster | Parallel fetching |
| NotionSource | baseline | 3x faster | Block caching |

### Build Performance

- Health validators: 312ms saved per build
- Directive rendering check removed: 1s saved per build
- Docs nav macro: 13x faster rendering
- Cache size: 40% reduction (~2.8M savings)

---

## üîí Thread Safety

Full support for Python 3.14's free-threading (PEP 703):

- `DirectiveCache._lock` for concurrent directive access
- `_icon_lock` for thread-safe icon resolution
- Double-check locking in rendering context
- GIL-safe syntax highlighting via Rosettes

---

## üì¶ Autodoc

- **OpenAPI layouts**: Three-panel scroll-sync REST API reference
- **View filters**: `PostView`, `ReleaseView`, `AuthorView`, `TagView`
- **Theme helpers**: `MemberView`, `CommandView`, `OptionView`
- **Kida migration**: All autodoc templates now use Kida

---

## üîç Health Check

- **Error codes**: H-prefix schema (H0xx-H9xx)
- **CLI option**: `--ignore` for selective validation
- **AutoFixer**: O(1) dict lookup for fence fixes

---

## üìù Documentation

- 15+ accuracy fixes across versioning, i18n, authoring, filtering
- Kida Template Engine Concepts crash course
- 62 code blocks with language designators for Rosettes

---

## Breaking Changes

None. This release is backward compatible with 0.1.6.

---

## Deprecations

- **Component preview**: Removed from dev server
- **Module shadowing**: Backward-compat shims removed
- **Autodoc aliases**: Legacy compatibility code removed

---

## Upgrade Guide

```bash
# Upgrade Bengal
pip install --upgrade bengal

# Or with uv
uv pip install --upgrade bengal
```

No configuration changes required. Kida is the new default template engine, but Jinja2 templates continue to work.

To explicitly use Jinja2:

```yaml
template_engine: jinja2
```

---

## Full Changelog

See the [changelog](https://github.com/lbliii/bengal/blob/main/changelog.md) for the complete list of changes.

---

## Contributors

Thanks to everyone who contributed to this release!
