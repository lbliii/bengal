# Search Special Page - Implementation Plan

## Goals
- Make search page generated by default like 404 (opt-out)
- Support custom template via config and theme/site overrides
- Prefer user-authored `content/search.md` when present
- Ensure page excluded from search index

## Config
- New optional section in `bengal.toml`:

```toml
[search]
enabled = true              # default
path = "/search/"         # default; must start and end with '/'
template = "search.html"   # default template name
```

## Generation Rules
- Run during postprocess via `SpecialPagesGenerator`
- Skip if `search.enabled = false`
- Skip if `content/search.md` exists (user-managed)
- Skip if template cannot be found by `TemplateEngine`
- Output to `<output_dir>/search/index.html` when path ends with `/`
- Exclude from output formats and search index

## Template Resolution
- Use `site.template_engine.env.get_template(config_template)`
- Users can override by placing `templates/search.html` in site or theme

## Implementation Tasks
1) Add config read helpers (fallback defaults) in generator
2) Implement `_generate_search()` in `bengal/postprocess/special_pages.py`
   - Build minimal page-like context (`title`, `url`, `kind`, `metadata.search_exclude = true`)
   - Render with template
   - Write to `search/index.html` (or custom path)
3) Call `_generate_search()` from `generate()` with logging
4) Tests
   - Generates when enabled and no content file exists
   - Skips when disabled
   - Skips when `content/search.md` exists
   - Uses custom path/template
   - Writes to `search/index.html`
5) Docs/Examples
   - Update `bengal.toml.example` with `[search]` block (commented)
   - Update README/GETTING_STARTED and example site to note default behavior
   - Keep `examples/showcase/content/search.md` but clarify it overrides the generated page

## Edge Cases
- Custom `path` without trailing slash → normalize to directory form `/path/`
- Theme missing `search.html` → log and skip
- Baseurl handling: build `url` using path; actual absolute URL constructed by templates as needed

## Non-Goals
- Server-side search or indexing changes (client-side via `index.json` remains)
- Modal search UI (handled by front-end template/JS)
