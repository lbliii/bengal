# Autodoc CSS Enhancement Plan
**Date:** October 4, 2025  
**Status:** Planning  
**Priority:** Medium

## Executive Summary

After analyzing the HTML output at `http://localhost:5174/api/`, we identified that while the API overview pages have dedicated styling (`reference-docs.css`), the actual autogenerated API documentation content pages rely on generic typography styles (`.prose` class). This creates an opportunity to significantly enhance the visual design and usability of API documentation.

## Current State Analysis

### What Works Well

1. **API Index Pages** (`/api/`, `/cli/`)
   - Clean card-based grid layout (`.api-module-card`)
   - Good visual hierarchy with icons and stats
   - Responsive design with hover effects
   - Consistent with the theme's design language

2. **Base Typography** (`.prose` class)
   - Solid foundation for general content
   - Good readability and spacing
   - Responsive and accessible

### What Needs Improvement

1. **API Content Pages** (e.g., `/api/cache/build_cache/`)
   - Uses generic `.prose` styles meant for narrative content
   - No visual distinction for API-specific elements:
     - Method/function signatures
     - Parameter lists
     - Return types
     - Type annotations
     - Class inheritance
     - Property decorators
   - Code blocks lack syntax highlighting context
   - No interactive features (copy buttons, expand/collapse)
   - Parameter lists are just bullets - not optimized for technical docs

2. **Specific Issues Found:**

```html
<!-- Current Output (lacks semantic structure): -->
<li><strong>cache_path</strong> (<code>Path</code>) - Path to cache file</li>
```

This should have:
- Dedicated parameter styling
- Better visual separation of name/type/description
- Monospace font for parameter names
- Color coding for types

3. **Missing Features:**
   - No "copy signature" buttons for code blocks
   - No visual indicators for async methods, properties, class methods
   - No collapsible sections for long API docs
   - Source links not prominently styled
   - No syntax highlighting for inline code types

## Research Findings

### Industry Best Practices (from web research)

**Stripe API Docs:**
- Clean two-column layout (description + code examples side-by-side)
- Type annotations with color coding
- Interactive code samples with language tabs
- Copy buttons on all code blocks

**GitHub API Docs:**
- Clear visual hierarchy for endpoints
- Badge-style indicators for HTTP methods (GET, POST, etc.)
- Dedicated styling for parameters, responses, examples
- Collapsible sections for large payloads

**Key Takeaways:**
1. API documentation needs **more structure** than narrative content
2. **Visual indicators** (badges, icons) help scanning
3. **Interactive elements** (copy, collapse) improve UX
4. **Type information** should be visually distinct
5. **Code examples** are first-class citizens, not afterthoughts

## Proposal: Dedicated API Documentation CSS

### Option 1: New Dedicated File (Recommended)
**File:** `bengal/themes/default/assets/css/components/api-docs.css`

**Pros:**
- Clean separation of concerns
- Easy to maintain and override
- Users can customize API docs independently
- Better for themeing

**Cons:**
- Another file to load (minimal impact with modern browsers)

### Option 2: Extend Reference Docs CSS
**File:** Add to `bengal/themes/default/assets/css/components/reference-docs.css`

**Pros:**
- Keeps API-related styles together
- One fewer HTTP request

**Cons:**
- File becomes large and less focused
- Harder to override just content styles

**Recommendation:** Option 1 - create dedicated `api-docs.css`

## Detailed Enhancement Specifications

### 1. API Element Styles

#### A. Method/Function Signatures
```css
/* Signature Block */
.api-signature {
  background: var(--color-surface);
  border-left: 4px solid var(--color-primary);
  padding: var(--space-m);
  border-radius: var(--radius-m);
  font-family: var(--font-mono);
  position: relative;
  margin: var(--space-m) 0;
}

/* Copy button for signatures */
.api-signature-copy {
  position: absolute;
  top: var(--space-s);
  right: var(--space-s);
  opacity: 0;
  transition: opacity 0.2s;
}

.api-signature:hover .api-signature-copy {
  opacity: 1;
}
```

#### B. Parameters Table
```css
/* Replace bullet lists with structured parameter table */
.api-parameters {
  margin: var(--space-m) 0;
}

.api-parameter {
  display: grid;
  grid-template-columns: minmax(120px, 1fr) minmax(100px, auto) 2fr;
  gap: var(--space-m);
  padding: var(--space-s) var(--space-m);
  border-bottom: 1px solid var(--color-border-light);
}

.api-parameter-name {
  font-family: var(--font-mono);
  font-weight: var(--font-semibold);
  color: var(--color-primary);
}

.api-parameter-type {
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  background: var(--color-bg-code);
  padding: 0.125em 0.5em;
  border-radius: var(--radius-s);
  width: fit-content;
}

.api-parameter-description {
  color: var(--color-text-secondary);
  line-height: var(--line-height-relaxed);
}
```

#### C. Return Types & Raises
```css
.api-returns,
.api-raises {
  margin: var(--space-m) 0;
  padding: var(--space-m);
  background: var(--color-surface);
  border-radius: var(--radius-m);
}

.api-returns-label,
.api-raises-label {
  font-weight: var(--font-semibold);
  color: var(--color-text-primary);
  display: flex;
  align-items: center;
  gap: var(--space-s);
  margin-bottom: var(--space-s);
}

.api-returns-type {
  font-family: var(--font-mono);
  color: var(--color-success);
  background: var(--color-success-bg);
  padding: 0.25em 0.5em;
  border-radius: var(--radius-s);
}

.api-exception {
  font-family: var(--font-mono);
  color: var(--color-danger);
  background: var(--color-danger-bg);
  padding: 0.25em 0.5em;
  border-radius: var(--radius-s);
}
```

#### D. Visual Indicators & Badges
```css
/* Badges for method types */
.api-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  padding: 0.25em 0.75em;
  border-radius: var(--radius-s);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.api-badge-async {
  background: var(--color-info-bg);
  color: var(--color-info);
  border: 1px solid var(--color-info-light);
}

.api-badge-property {
  background: var(--color-success-bg);
  color: var(--color-success);
  border: 1px solid var(--color-success-light);
}

.api-badge-classmethod {
  background: var(--color-warning-bg);
  color: var(--color-warning);
  border: 1px solid var(--color-warning-light);
}

.api-badge-deprecated {
  background: var(--color-danger-bg);
  color: var(--color-danger);
  border: 1px solid var(--color-danger-light);
}
```

#### E. Class/Module Headers
```css
.api-class-header,
.api-module-header {
  display: flex;
  align-items: center;
  gap: var(--space-m);
  margin: var(--space-l) 0 var(--space-m);
  padding-bottom: var(--space-m);
  border-bottom: 2px solid var(--color-border);
}

.api-class-icon,
.api-module-icon {
  font-size: var(--text-2xl);
}

.api-source-link {
  margin-left: auto;
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  padding: var(--space-xs) var(--space-s);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-s);
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  text-decoration: none;
  transition: all 0.2s;
}

.api-source-link:hover {
  color: var(--color-primary);
  border-color: var(--color-primary);
}
```

### 2. Interactive Features

#### A. Copy Buttons
```css
.api-copy-button {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  padding: 0.5rem;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-s);
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s, background 0.2s;
}

pre:hover .api-copy-button,
.api-signature:hover .api-copy-button {
  opacity: 1;
}

.api-copy-button:hover {
  background: var(--color-primary);
  color: white;
}
```

#### B. Collapsible Sections
```css
.api-collapsible {
  border: 1px solid var(--color-border);
  border-radius: var(--radius-m);
  margin: var(--space-m) 0;
}

.api-collapsible-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-m);
  cursor: pointer;
  background: var(--color-surface);
  transition: background 0.2s;
}

.api-collapsible-header:hover {
  background: var(--color-bg-hover);
}

.api-collapsible-content {
  padding: var(--space-m);
  border-top: 1px solid var(--color-border);
  display: none;
}

.api-collapsible.is-open .api-collapsible-content {
  display: block;
}

.api-collapsible-icon {
  transition: transform 0.2s;
}

.api-collapsible.is-open .api-collapsible-icon {
  transform: rotate(90deg);
}
```

### 3. Code & Syntax Enhancements

```css
/* Enhanced inline code in API contexts */
.prose .api-parameters code,
.prose .api-returns code,
.prose .api-raises code {
  background: var(--color-bg-code);
  color: var(--color-code-type);
  font-weight: var(--font-medium);
}

/* Type annotations get special treatment */
.api-type {
  font-family: var(--font-mono);
  color: var(--color-code-type);
  background: var(--color-bg-code);
  padding: 0.125em 0.375em;
  border-radius: var(--radius-xs);
  font-size: 0.9em;
  font-weight: var(--font-medium);
}

/* Signature code blocks */
.api-signature pre {
  margin: 0;
  padding: 0;
  background: transparent;
  border: none;
}
```

### 4. Responsive Design

```css
/* Mobile-friendly parameter tables */
@media (max-width: 768px) {
  .api-parameter {
    grid-template-columns: 1fr;
    gap: var(--space-xs);
  }
  
  .api-parameter-name::after {
    content: ':';
  }
  
  .api-signature {
    font-size: var(--text-sm);
    overflow-x: auto;
  }
}
```

## Template Changes Required

### Current Structure
```markdown
**Parameters:**

- **cache_path** (`Path`) - Path to cache file
```

### Proposed Structure
```html
<div class="api-parameters">
  <div class="api-parameters-header">
    <h5>Parameters</h5>
  </div>
  <div class="api-parameter">
    <span class="api-parameter-name">cache_path</span>
    <span class="api-parameter-type">Path</span>
    <span class="api-parameter-description">Path to cache file</span>
  </div>
</div>
```

This requires updating:
- `bengal/autodoc/templates/python/module.md.jinja2`
- `bengal/autodoc/templates/cli/command.md.jinja2`

**Alternative:** Use custom directives in markdown that get rendered with special CSS:
```markdown
::: api-parameters
| Name | Type | Description |
|------|------|-------------|
| cache_path | Path | Path to cache file |
:::
```

Then style `.api-parameters table` accordingly.

## Implementation Plan

### Phase 1: Core Styles (Priority: High)
**Estimated Time:** 4-6 hours

1. ✅ Create `api-docs.css` file
2. ✅ Implement parameter table styles
3. ✅ Implement signature block styles  
4. ✅ Implement badges for method types
5. ✅ Add to `style.css` imports
6. ✅ Test on existing API pages

**Deliverables:**
- New CSS file with core API documentation styles
- Visual improvements immediately visible on existing pages

### Phase 2: Interactive Features (Priority: Medium)
**Estimated Time:** 3-4 hours

1. ✅ Add copy button JavaScript
2. ✅ Implement collapsible sections
3. ✅ Add hover interactions
4. ✅ Mobile testing and refinement

**Deliverables:**
- `api-interactions.js` for copy buttons and collapsible sections
- Better mobile experience

### Phase 3: Template Enhancements (Priority: Medium)
**Estimated Time:** 4-6 hours

1. ✅ Update Python module template
2. ✅ Update CLI command template
3. ✅ Add badges for decorators (@property, @classmethod, async)
4. ✅ Improve source file links
5. ✅ Test with real autodoc generation

**Deliverables:**
- Enhanced Jinja2 templates
- Better structured HTML output

### Phase 4: Advanced Features (Priority: Low)
**Estimated Time:** 6-8 hours

1. ⬜ Add API navigation sidebar
2. ⬜ Implement quick search within API docs
3. ⬜ Add "edit on GitHub" links
4. ⬜ Implement version selector (for versioned docs)
5. ⬜ Add examples syntax highlighting

**Deliverables:**
- Premium API documentation experience
- Feature parity with industry leaders

## Design Tokens Needed

Add these to `tokens/semantic.css`:

```css
/* API Documentation Colors */
--color-code-type: #0066cc;
--color-code-keyword: #d73a49;
--color-code-string: #032f62;
--color-code-number: #005cc5;

/* Status Colors for Badges */
--color-success-bg: #d4edda;
--color-success-light: #c3e6cb;
--color-info-bg: #d1ecf1;
--color-info-light: #bee5eb;
--color-warning-bg: #fff3cd;
--color-warning-light: #ffeaa7;
--color-danger-bg: #f8d7da;
--color-danger-light: #f5c6cb;
```

## Testing Strategy

### Visual Testing
1. ✅ Test on `/api/cache/build_cache/` (complex class with many methods)
2. ✅ Test on `/api/cli/` (different structure)
3. ✅ Test on mobile devices (< 768px)
4. ✅ Test dark mode compatibility
5. ✅ Test with different zoom levels

### Accessibility Testing
1. ✅ Ensure proper heading hierarchy
2. ✅ Verify keyboard navigation works
3. ✅ Check color contrast ratios
4. ✅ Test with screen readers
5. ✅ Ensure focus indicators are visible

### Cross-Browser Testing
1. ✅ Chrome/Chromium
2. ✅ Firefox
3. ✅ Safari
4. ✅ Mobile browsers

## Success Metrics

1. **Visual Clarity:** API documentation is visually distinct from narrative content
2. **Scannability:** Users can quickly find parameter types and return values
3. **Usability:** Copy buttons and collapsible sections work smoothly
4. **Responsive:** Works well on mobile and desktop
5. **Consistent:** Matches Bengal's existing design language
6. **Accessible:** Meets WCAG 2.1 AA standards

## Open Questions

1. **Should we use table layout or grid for parameters?**
   - Recommendation: Grid for better responsiveness

2. **How prominent should source file links be?**
   - Recommendation: Secondary action in header, not distracting

3. **Should examples be collapsible by default?**
   - Recommendation: No, keep visible (examples are valuable)

4. **Do we need syntax highlighting for Python signatures?**
   - Recommendation: Yes, but Phase 4 (use existing syntax highlighter)

5. **Should we generate a separate "quick reference" page?**
   - Recommendation: Future enhancement, not in initial scope

## Conclusion

**Recommendation:** Proceed with dedicated CSS for autodoc features.

**Rationale:**
1. Current generic styles don't serve API documentation well
2. Industry best practices show API docs need specialized styling
3. Users expect structured, scannable API documentation
4. Implementation is straightforward and doesn't break existing functionality
5. Provides immediate value with Phase 1, with clear path to advanced features

**Next Steps:**
1. Review and approve this plan
2. Begin Phase 1 implementation
3. Iterate based on visual testing
4. Document new styles and patterns for theme customization

---

**Document Status:** Ready for Review  
**Last Updated:** October 4, 2025  
**Owner:** Development Team

