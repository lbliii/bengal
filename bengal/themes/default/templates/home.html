{% extends "base.html" %}

{% block content %}
{# Home page - no action bar needed #}
{# Note: Home page manages its own containment for edge-to-edge hero sections #}
<div class="home">
    {# Hero Section #}
    {% set hero_classes = ['hero', 'hero--large'] %}
    {% if params.blob_background %}
    {% do hero_classes.append('hero--blob-background') %}
    {% end %}
    <header class="{{ hero_classes | join(' ') }}">
        {% if params.blob_background %}
        {# Organic blob background animation #}
        <div class="hero__blobs" aria-hidden="true">
            <div class="hero__blob hero__blob--1"></div>
            <div class="hero__blob hero__blob--2"></div>
            <div class="hero__blob hero__blob--3"></div>
            <div class="hero__blob hero__blob--4"></div>
        </div>
        {% end %}
        <div class="hero__container">
            <div class="hero__content">
                <h1 class="hero__title">
                    <span class="fluid-text">{{ page.title | default(config.title) }}</span>
                </h1>
                {% if params.description %}
                <p class="hero__subtitle">{{ params.description }}</p>
                {% end %}

                {% if params.cta_buttons %}
                <div class="hero__actions">
                    {% for button in params.cta_buttons %}
                    <a href="{{ button.href or button.url | absolute_url }}"
                        class="hero__button hero__button--{{ button.style | default('primary') }} {% if button.style != 'primary' %}gradient-border{% end %}">
                        {{ button.text }}
                    </a>
                    {% end %}
                </div>
                {% end %}
            </div>
        </div>
    </header>

    {# Feature Highlights - Value Proposition Grid #}
    {% if params.features %}
    <section class="features" aria-label="Key features">
        <div class="features-grid">
            {% for feature in params.features %}
            <article class="feature-card">
                {% if feature.icon %}
                <div class="feature-icon" aria-hidden="true">{{ feature.icon }}</div>
                {% end %}
                <h3 class="feature-title">{{ feature.title }}</h3>
                <p class="feature-description">{{ feature.description }}</p>
                {% if feature.link %}
                <a href="{{ feature.link.href or feature.link.url | absolute_url }}" class="feature-link">
                    {{ feature.link.text | default('Learn more') }}
                    <span aria-hidden="true">→</span>
                </a>
                {% end %}
            </article>
            {% end %}
        </div>
    </section>
    {% end %}

    {# Main Content #}
    <div class="home-content prose">
        {{ content | safe }}
    </div>

    {# Quick Links Section - Navigation Cards #}
    {% if params.quick_links %}
    <section class="quick-links" aria-label="Quick navigation">
        <h2>Quick Links</h2>
        <div class="quick-links-grid">
            {% for link in params.quick_links %}
            <a href="{{ link.href or link.url | absolute_url }}" class="quick-link-card">
                {% if link.icon %}
                <div class="quick-link-icon" aria-hidden="true">{{ link.icon }}</div>
                {% end %}
                <h3>{{ link.title }}</h3>
                {% if link.description %}
                <p>{{ link.description }}</p>
                {% end %}
            </a>
            {% end %}
        </div>
    </section>
    {% end %}

    {# Statistics/Metrics Section - Impressive Numbers #}
    {% if params.stats %}
    <section class="stats" aria-label="Key metrics">
        <div class="stats-grid">
            {% for stat in params.stats %}
            <div class="stat-card">
                <div class="stat-value">{{ stat.value }}</div>
                <div class="stat-label">{{ stat.label }}</div>
            </div>
            {% end %}
        </div>
    </section>
    {% end %}

    {# Recent Posts/Updates (if this is a blog-style home) #}
    {# Show recent posts by default for blog sites, or if explicitly enabled #}
    {% set show_recent = params.show_recent_posts | default(true) %}
    {% if show_recent %}
    {# Find blog section and get recent posts #}
    {% set blog_section_name = params.blog_section | default('blog') %}
    {% set blog_section_candidates = site.sections | selectattr('name', 'equalto', blog_section_name) | list if
    site.sections else [] %}
    {% set blog_section = blog_section_candidates[0] if blog_section_candidates else None %}
    {% if blog_section and blog_section.pages %}
    {% set recent = blog_section.pages | selectattr('date') | sort_by('date', reverse=true) | limit(3) %}
    {% elif site.pages %}
    {# Fallback: find blog posts by URL path or metadata type #}
    {% set blog_posts = [] %}
    {% for p in site.pages %}
    {# Use relative_url for comparisons (without baseurl) #}
    {% if p.metadata.type == 'blog' or '/blog/' in p._path %}
    {% do blog_posts.append(p) %}
    {% end %}
    {% end %}
    {% set recent = blog_posts | selectattr('date') | sort_by('date', reverse=true) | limit(3) %}
    {% else %}
    {% set recent = [] %}
    {% end %}

    {% if recent %}
    <section class="recent-posts">
        <h2 class="recent-posts-title">Recent Posts</h2>
        <div class="posts-grid">
            {% for post in recent %}
            <article class="post-card gradient-border fluid-combined">
                {% if post.metadata.image or post.metadata.cover %}
                <div class="post-card-image">
                    <a href="{{ post.href }}">
                        <img src="{{ post.metadata.image | default(post.metadata.cover) }}"
                            alt="{{ post.title }}">
                    </a>
                </div>
                {% end %}
                <div class="post-card-content">
                    <h3 class="post-card-title"><a href="{{ post.href }}">{{ post.title }}</a></h3>
                    {% if post.date %}
                    <time datetime="{{ post.date | date_iso }}" class="post-card-date">
                        {{ post.date | dateformat('%B %d, %Y') }}
                    </time>
                    {% end %}
                    {% if post.metadata.description or post.excerpt %}
                    <p class="post-card-excerpt">
                        {{ post.metadata.description | default(post.excerpt) | truncate(150) }}
                    </p>
                    {% end %}
                    <a href="{{ post.href }}" class="read-more">Read more →</a>
                </div>
            </article>
            {% end %}
        </div>
    </section>
    {% end %}
    {% end %}
</div>

{# Styles moved to assets/css/pages/home.css #}
{% end %}
