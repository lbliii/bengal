{% extends "base.html" %}

{#
CLI Reference Command Group Template

Renders a CLI command group's documentation showing nested commands and groups.
Extends base.html to inherit theme navigation, sidebars, and styling.
Uses semantic CSS tokens and patterns from autodoc-explorer.css.

This template receives:
- element: DocElement for the command group
- config: Autodoc configuration
- site: Site instance
#}

{% from 'partials/navigation-components.html' import breadcrumbs, page_navigation, toc with context %}

{% block content %}
{# Three-column documentation layout #}
<div class="docs-layout">
  {# Left Sidebar: Navigation #}
  <aside class="docs-sidebar" id="docs-sidebar" role="navigation" aria-label="CLI navigation">
    {% include 'partials/docs-nav.html' %}
  </aside>

  {# Main Content #}
  <div class="docs-main">
    {# Page Hero: Breadcrumbs + Badges + Title + Description + Stats #}
    {% include 'partials/page-hero/element.html' %}

    {# Article Content - flattened structure #}
    <article class="prose docs-content {% if page.metadata.get('css_class') %}{{ page.metadata.get('css_class') }}{% endif %}">
      {# CLI Command Group Content #}
      <div class="autodoc-explorer">
          {# Usage #}
          {% if element.qualified_name %}
          <div class="api-usage">
            <h3 class="api-label">Usage</h3>
            <div class="code-block-wrapper">
              <div class="code-header-inline">
                <span class="code-language">Bash</span>
              </div>
              <pre><code class="language-bash">{{ element.qualified_name }} [COMMAND] [OPTIONS]</code></pre>
            </div>
          </div>
          {% endif %}

          {# Commands and Sub-groups #}
          {% if element.children %}
          <section class="api-section api-section--commands">
            <h2 class="api-section__title">Commands</h2>
            <div class="api-grid api-grid--modules">
              {% for child in element.children %}
              {% if child.element_type == "command" %}
              <a href="/cli/{{ child.qualified_name | replace('.', '/') }}/" class="api-card api-card--link api-card--command">
                <div class="api-card__header">
                  <span class="api-card__icon">{{ icon("terminal", size=16, css_class="icon-success") }}</span>
                  <span class="api-card__title">{{ child.name }}</span>
                </div>
                <div class="api-card__body">
                  {% if child.description %}
                  <p class="api-card__description">{{ child.description | truncatewords(15) }}</p>
                  {% else %}
                  <p class="api-card__description">No description available</p>
                  {% endif %}
                </div>
              </a>
              {% elif child.element_type == "command-group" %}
              <a href="/cli/{{ child.qualified_name | replace('.', '/') }}/" class="api-card api-card--link api-card--package">
                <div class="api-card__header">
                  <span class="api-card__icon">{{ icon("folder", size=20, css_class="icon-muted") }}</span>
                  <span class="api-card__title">{{ child.name }}</span>
                </div>
                <div class="api-card__body">
                  {% if child.description %}
                  <p class="api-card__description">{{ child.description | truncatewords(15) }}</p>
                  {% else %}
                  <p class="api-card__description">{{ child.name }} commands</p>
                  {% endif %}
                </div>
                <div class="api-card__footer">
                  <span class="api-card__meta">
                    {{ child.children | length }} command{{ 's' if child.children | length != 1 else '' }}
                  </span>
                </div>
              </a>
              {% endif %}
              {% endfor %}
            </div>
          </section>
          {% endif %}
        </div>

      {# Tags #}
      {% if page.tags %}
      <footer class="docs-footer">
        <span class="docs-footer-label">Tagged</span>
        {% from 'partials/content-components.html' import tag_list with context %}
        {{ tag_list(page.tags) }}
      </footer>
      {% endif %}
    </article>

    {# Page navigation (prev/next) at bottom #}
    {{ page_navigation(page) }}
  </div>

  {# Right Sidebar: Contextual Graph + TOC + Metadata #}
  {% include 'partials/docs-toc-sidebar.html' %}
</div>

{# Mobile sidebar toggle button #}
<button class="docs-sidebar-toggle" aria-label="Toggle navigation sidebar" aria-expanded="false"
  aria-controls="docs-sidebar">
  {{ icon('list', size=20) }}
</button>

{# Sidebar overlay for mobile #}
<div class="docs-sidebar-overlay" aria-hidden="true"></div>
{% endblock %}
