{#
Navigation Node Component (Scaffold Mode)

Renders a NavNode WITHOUT per-page active state.
Active state is applied client-side via JS for progressive enhancement.

This template produces static HTML that can be cached across pages.
The JS enhancement reads data-nav-path attributes to apply active classes.

Variables:
- item: NavNodeProxy or ScaffoldNodeProxy to render (required)
- depth: Current nesting depth for styling (required)
- show_nav_icons: Whether to show section icons (default: true)

Features:
- Collapsible sections with toggle button
- All groups start collapsed (JS expands active trail)
- data-nav-path attributes for JS active state application
- Renders ALL children (no pruning - scaffold is cached)
#}

{% set show_nav_icons = show_nav_icons if show_nav_icons is defined else true %}
{% set item_title = item.title %}
{% set item_icon = item.icon %}

{% if item.has_children %}
{# ===== ROOT NODE (depth 0) - Static header, no toggle ===== #}
{% if depth == 0 %}
<div class="docs-nav-group docs-nav-group--root" data-depth="{{ depth }}" data-nav-path="{{ item._path }}">
  <div class="docs-nav-group-header">
    {% if show_nav_icons %}
    <span class="docs-nav-icon" {% if not item_icon %}data-default="true"{% endif %}>
      {{ icon(item_icon or 'folder', size=16) }}
    </span>
    {% endif %}

    {% if item.href %}
    <a href="{{ item.href }}"
       class="docs-nav-group-title"
       data-nav-path="{{ item._path }}">
      {{ item_title }}
    </a>
    {% else %}
    <span class="docs-nav-group-title">{{ item_title }}</span>
    {% endif %}
  </div>

  <div class="docs-nav-group-items">
    {% for child in item.children %}
      {% set item = child %}
      {% set depth = depth + 1 %}
      {% include 'partials/docs-nav-scaffold-node.html' %}
    {% endfor %}
  </div>
</div>

{% else %}
{# ===== EXPANDABLE NODE (has children, depth > 0) ===== #}
<div class="docs-nav-group" data-depth="{{ depth }}" data-nav-path="{{ item._path }}">
  <div class="docs-nav-group-toggle-wrapper">
    <button class="docs-nav-group-toggle"
            aria-expanded="false"
            aria-controls="nav-node-{{ item.id }}">
      {{ icon('caret-right', size=14) }}
    </button>

    {% if show_nav_icons %}
    <span class="docs-nav-icon" {% if not item_icon %}data-default="true"{% endif %}>
      {{ icon(item_icon or 'folder', size=16) }}
    </span>
    {% endif %}

    {% if item.href %}
    <a href="{{ item.href }}"
       class="docs-nav-group-link"
       data-nav-path="{{ item._path }}">
      {{ item_title }}
    </a>
    {% else %}
    <span class="docs-nav-group-link">{{ item_title }}</span>
    {% endif %}
  </div>

  <div class="docs-nav-group-items"
       id="nav-node-{{ item.id }}">
    {% for child in item.children %}
      {% set item = child %}
      {% set depth = depth + 1 %}
      {% include 'partials/docs-nav-scaffold-node.html' %}
    {% endfor %}
  </div>
</div>
{% endif %}

{% else %}
{# ===== LEAF NODE (no children) ===== #}
<div class="docs-nav-group docs-nav-group--leaf" data-depth="{{ depth }}" data-nav-path="{{ item._path }}">
  {% if item.href %}
  <a href="{{ item.href }}"
     class="docs-nav-link{% if item.is_section %} docs-nav-link--section{% endif %}"
     data-nav-path="{{ item._path }}">
    {% if show_nav_icons and item.is_section %}
    <span class="docs-nav-icon docs-nav-icon--section" {% if not item_icon %}data-default="true"{% endif %}>
      {{ icon(item_icon or 'folder', size=14) }}
    </span>
    {% endif %}
    <span class="docs-nav-link-text">{{ item_title }}</span>
  </a>
  {% else %}
  <span class="docs-nav-link{% if item.is_section %} docs-nav-link--section{% endif %}">
    {% if show_nav_icons and item.is_section %}
    <span class="docs-nav-icon docs-nav-icon--section" {% if not item_icon %}data-default="true"{% endif %}>
      {{ icon(item_icon or 'folder', size=14) }}
    </span>
    {% endif %}
    <span class="docs-nav-link-text">{{ item_title }}</span>
  </span>
  {% endif %}
</div>
{% endif %}
