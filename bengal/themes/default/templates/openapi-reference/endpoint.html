{% extends "base.html" %}

{#
OpenAPI Reference Endpoint Template

Three-panel layout optimized for REST API documentation:
- Left: Navigation tree
- Center: Endpoint details (parameters, responses, etc.)
- Right: Code examples panel

This template receives:
- element: DocElement for the endpoint
- config: Autodoc configuration
- site: Site instance
#}

{% from 'partials/navigation-components.html' import breadcrumbs, page_navigation, toc with context %}

{% block content %}
{# Three-panel REST API layout #}
<div class="docs-layout docs-layout--api-explorer">
  {# Left Sidebar: Navigation #}
  <aside class="docs-sidebar" id="docs-sidebar" role="navigation" aria-label="API navigation">
    {% include 'partials/docs-nav.html' %}
  </aside>

  {# Center: Endpoint Documentation #}
  <div class="docs-main api-docs-main">
    {# Endpoint Header #}
    <header class="api-endpoint-header">
      {{ breadcrumbs(page) }}
      <div class="api-endpoint-header__method-path">
        <span class="api-method-badge api-method-badge--{{ element.metadata.method | lower }}">{{ element.metadata.method | upper }}</span>
        <code class="api-endpoint-path">{{ element.metadata.path }}</code>
        {% if element.metadata.deprecated %}
        <span class="api-badge api-badge--deprecated">Deprecated</span>
        {% endif %}
      </div>
      {% if element.metadata.summary %}
      <p class="api-endpoint-header__summary">{{ element.metadata.summary }}</p>
      {% elif element.description %}
      <p class="api-endpoint-header__summary">{{ element.description }}</p>
      {% endif %}
      {% if element.metadata.operation_id %}
      <div class="api-endpoint-header__meta">
        <span class="api-meta-label">Operation ID:</span>
        <code class="api-meta-value">{{ element.metadata.operation_id }}</code>
      </div>
      {% endif %}
    </header>

    {# Endpoint Content #}
    <article class="api-endpoint-content">
      {# Parameters Section #}
      {% if element.metadata.parameters %}
      <section class="api-section" id="parameters">
        <h2 class="api-section__heading">Parameters</h2>
        {% include 'api-reference/partials/parameters-table.html' %}
      </section>
      {% endif %}

      {# Request Body Section #}
      {% if element.metadata.request_body %}
      <section class="api-section" id="request-body">
        <h2 class="api-section__heading">Request Body</h2>
        <div class="api-request-body">
          {% if element.metadata.request_body.get('description') %}
          <p class="api-request-body__description">{{ element.metadata.request_body.get('description') }}</p>
          {% endif %}
          {% if element.metadata.request_body.get('content') %}
          <div class="api-content-types">
            {% for content_type, schema in element.metadata.request_body.get('content', {}).items() %}
            <div class="api-content-type">
              <span class="api-content-type__label">{{ content_type }}</span>
            </div>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </section>
      {% endif %}

      {# Responses Section #}
      {% if element.metadata.responses %}
      <section class="api-section" id="responses">
        <h2 class="api-section__heading">Responses</h2>
        <div class="api-responses">
          {% for status_code, response in element.metadata.responses.items() %}
          <div class="api-response api-response--{{ status_code[:1] }}xx">
            <div class="api-response__header">
              <span class="api-response__status api-response__status--{{ status_code[:1] }}xx">{{ status_code }}</span>
              <span class="api-response__description">{{ response.get('description', 'No description') }}</span>
            </div>
            {% if response.get('content') %}
            <div class="api-response__content">
              {% for content_type, schema in response.get('content', {}).items() %}
              <span class="api-content-type__label">{{ content_type }}</span>
              {% endfor %}
            </div>
            {% endif %}
          </div>
          {% endfor %}
        </div>
      </section>
      {% endif %}

      {# Tags #}
      {% if page.tags %}
      <footer class="docs-footer">
        <span class="docs-footer-label">Tagged</span>
        {% from 'partials/content-components.html' import tag_list with context %}
        {{ tag_list(page.tags) }}
      </footer>
      {% endif %}
    </article>

    {# Page navigation (prev/next) at bottom #}
    {{ page_navigation(page) }}
  </div>

  {# Right Panel: Code Examples #}
  <aside class="api-examples-panel" id="api-examples" role="complementary" aria-label="Code examples">
    <div class="api-examples-panel__content">
      <h3 class="api-examples-panel__title">{{ icon('code', size=16) }} Code Examples</h3>

      {# Request Example #}
      <div class="api-example-block">
        <div class="api-example-block__header">
          <span class="api-example-block__label">Request</span>
        </div>
        <div class="api-example-block__code">
          <pre><code class="language-bash">curl -X {{ element.metadata.method | upper }} \
  "https://api.example.com{{ element.metadata.path }}"{% if element.metadata.method | upper in ['POST', 'PUT', 'PATCH'] %} \
  -H "Content-Type: application/json" \
  -d '{}'{% endif %}</code></pre>
        </div>
      </div>

      {# Response Examples #}
      {% if element.metadata.responses %}
      {% for status_code, response in element.metadata.responses.items() %}
      {% if status_code[:1] == '2' %}
      <div class="api-example-block api-example-block--response">
        <div class="api-example-block__header">
          <span class="api-example-block__label">Response</span>
          <span class="api-example-block__status api-example-block__status--{{ status_code[:1] }}xx">{{ status_code }}</span>
        </div>
        <div class="api-example-block__code">
          <pre><code class="language-json">{
  "status": "success"
}</code></pre>
        </div>
      </div>
      {% endif %}
      {% endfor %}
      {% endif %}
    </div>
  </aside>
</div>

{# Mobile sidebar toggle button #}
<button class="docs-sidebar-toggle" aria-label="Toggle navigation sidebar" aria-expanded="false"
  aria-controls="docs-sidebar">
  {{ icon('list', size=20) }}
</button>

{# Sidebar overlay for mobile #}
<div class="docs-sidebar-overlay" aria-hidden="true"></div>
{% endblock %}
