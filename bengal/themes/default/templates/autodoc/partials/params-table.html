{#
Autodoc Parameters Table Partial

Renders parameters/options/arguments as a table.

Required: params (list of DocElements)
Optional: title (str), param_type (str: 'option', 'argument', 'parameter')

DocElements have:
- name: parameter name
- description: parameter description
- metadata: dict with opts, type, default, required
#}

{% set title = title | default('Parameters') %}
{% set param_type = param_type | default('parameter') %}

{% if params %}
<section class="autodoc-section" data-section="parameters">
  <h2 class="autodoc-section-title">{{ title }}</h2>

  <table class="autodoc-table" data-table="parameters">
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      {% for param in params %}
      {# Access metadata safely - DocElements have .metadata dict #}
      {% set meta = (param.metadata or {}) %}
      {% set is_required = meta.required | default(false) %}
      {# CLI options have opts array (like ['--verbose', '-v']), use that or fall back to name #}
      {% set param_name = meta.opts | join(', ') if meta.opts else param.name %}
      {% set param_type_val = meta.type | default('') %}
      {% set param_default = meta.default | default('') %}
      {# Check both description (DocElement) and docstring (raw dict) #}
      {% set param_desc = param.description or (meta.docstring if meta.docstring else '—') %}
      <tr data-required="{{ 'true' if is_required else 'false' }}">
        <td class="autodoc-cell-name" data-label="Name"><code>{{ param_name }}</code></td>
        <td class="autodoc-cell-type" data-label="Type"><code>{{ param_type_val or '—' }}</code></td>
        <td class="autodoc-cell-default" data-label="Default">
          {%- if param_default -%}
          <code>{{ param_default }}</code>
          {%- else -%}
          <span class="table-empty">—</span>
          {%- endif -%}
        </td>
        <td class="autodoc-cell-desc" data-label="Description">{{ param_desc }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endif %}
