{% extends "base.html" %}
{#
================================================================================
INK THEME - Home Page (Kida-Native)
================================================================================
Minimal landing page with hero and optional content.

KIDA FEATURES USED:
- {% let %} multi-let for grouped variable definitions
- Optional chaining (?.) for safe nested access
- Null coalescing (??) for fallback values
- Pipeline operator (|>) for filter chains
- {% match %} for content display logic
================================================================================
#}

{# Multi-let for all template variables #}
{% let
_title = page?.title ?? config?.title ?? 'Welcome',
_description = page?.description ?? config?.description ?? '',
_has_content = page?.content is defined and page.content | length > 0,
_show_featured = page?.params?.show_featured ?? false,
_featured_count = page?.params?.featured_count ?? 3 %}

{% block content %}
<div class="container">
    {# Hero section #}
    <section class="home-hero">
        <h1>{{ _title }}</h1>

        {% if _description | length > 0 %}
        <p class="lead">{{ _description }}</p>
        {% end %}
    </section>

    {# Page content #}
    {% match _has_content %}
    {% case true %}
    <article class="content">
        {{ page.content | safe }}
    </article>
    {% case false %}
    {% end %}

    {# Optional: Featured posts #}
    {% if _show_featured %}
    {% let _featured = pages_by_section('blog')
    |> where('draft', false)
    |> where('featured', true)
    |> sort(attribute='date', reverse=true)
    |> take(_featured_count) %}

    {% if _featured | length > 0 %}
    <section class="featured-posts">
        <h2>Featured</h2>
        <ul class="post-list">
            {% for post in _featured %}
            {# Multi-let for featured post data #}
            {% let
            _post_title = post?.title ?? 'Untitled',
            _post_url = post?._path ?? '#',
            _post_excerpt = post?.excerpt ?? '' %}
            <li class="post-item">
                <h3><a href="{{ _post_url | absolute_url }}">{{ _post_title }}</a></h3>
                {% if _post_excerpt | length > 0 %}
                <p class="excerpt">{{ _post_excerpt | truncate(120) }}</p>
                {% end %}
            </li>
            {% end %}
        </ul>
    </section>
    {% end %}
    {% end %}
</div>
{% end %}
